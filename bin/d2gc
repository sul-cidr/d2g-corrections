#!/usr/bin/env python


import click
import csv

from d2gc.corpus import Corpus


@click.command()
@click.argument('corrections', type=click.File(encoding='utf-8'))
def d2gc(corrections):

    """
    Apply name corrections to the d2g corpus.
    """

    reader = csv.DictReader(corrections)
    corpus = Corpus.from_env()

    for row in reader:
        corpus.correct(
            row['NAME'].strip(),
            row['CORRECTED NAME'].strip(),
            row['ALPHABETIZED NAME'].strip(),
        )


if __name__ == '__main__':
    d2gc()
